angular.module('IPAT')
  .controller('ProjectDetailsCtrl', function ($scope, $stateParams, ProjectApi, uiGmapGoogleMapApi, uiGmapIsReady) {
    'use strict';
    var projects = {
      '13': {
        'name': 'Berlin Mittelheide',
        'map': {center: {latitude: 52.4626536896816, longitude: 13.607287460327143}, zoom: 16},
        'coords': [
          [52.463658, 13.604811],
          [52.463338, 13.608452],
          [52.461634, 13.607567],
          [52.461961, 13.604407]
        ]
      },
      '12': {
        'name': 'Wallendorf II',
        'map': {center: {latitude: 51.3516, longitude: 12.0952}, zoom: 16},
        'coords': [
          [51.352587642329034, 12.09371566772461],
          [51.35264459601718, 12.09393560886383],
          [51.35264459601718, 12.094112634658813],
          [51.35264124580219, 12.094252109527588],
          [51.352631195155766, 12.094493508338928],
          [51.35261444407346, 12.09469199180603],
          [51.35261444407346, 12.094869017601013],
          [51.352594342766636, 12.095067501068115],
          [51.35257759167085, 12.095271348953247],
          [51.352560840568955, 12.09546446800232],
          [51.35255749034786, 12.095620036125183],
          [51.352550789904896, 12.095823884010315],
          [51.3525340387932, 12.096054553985596],
          [51.35251728767538, 12.096247673034668],
          [51.352503886776724, 12.09644615650177],
          [51.352503886776724, 12.096564173698425],
          [51.352503886776724, 12.09669291973114],
          [51.35247708496764, 12.096869945526123],
          [51.35244358268424, 12.097004055976868],
          [51.352389978979836, 12.097116708755493],
          [51.35230622306616, 12.097218632698059],
          [51.352202365520554, 12.097283005714417],
          [51.352142061031216, 12.097379565238953],
          [51.352085106718384, 12.097476124763489],
          [51.352021451814366, 12.097658514976501],
          [51.3519845989348, 12.097856998443604],
          [51.35192429415883, 12.098044753074646],
          [51.35187404011821, 12.09821105003357],
          [51.351810384920974, 12.098312973976135],
          [51.351746729635295, 12.098404169082642],
          [51.351662972545725, 12.098538279533386],
          [51.351569164423616, 12.098608016967773],
          [51.351485407009456, 12.098650932312012],
          [51.3513748469883, 12.098667025566101],
          [51.351247535118304, 12.098720669746399],
          [51.351200630655974, 12.098758220672607],
          [51.35111352224141, 12.098790407180786],
          [51.35102641366123, 12.098790407180786],
          [51.35091250219114, 12.098817229270935],
          [51.35083544427136, 12.098833322525024],
          [51.350738284100835, 12.098876237869263],
          [51.35065117480727, 12.098892331123352],
          [51.35057411644801, 12.098892331123352],
          [51.35050375870245, 12.098892331123352],
          [51.350466904602136, 12.098892331123352],
          [51.35043005047218, 12.09868848323822],
          [51.350376444412056, 12.098414897918701],
          [51.35034964135846, 12.098221778869629],
          [51.35029603520427, 12.097985744476318],
          [51.350269232103656, 12.097722887992859],
          [51.35022567703171, 12.097502946853638],
          [51.35019217310202, 12.097250819206238],
          [51.3501620195444, 12.097020149230957],
          [51.350155318751106, 12.096800208091736],
          [51.35015196835409, 12.096585631370544],
          [51.350182121918365, 12.096344232559204],
          [51.35021897624773, 12.096076011657715],
          [51.35024912976791, 12.095818519592285],
          [51.35025918093686, 12.095566391944885],
          [51.35027593288028, 12.095389366149902],
          [51.35027593288028, 12.095158696174622],
          [51.35027593288028, 12.094922661781311],
          [51.35027928326821, 12.094724178314209],
          [51.35027928326821, 12.094493508338928],
          [51.35027593288028, 12.094246745109558],
          [51.35027593288028, 12.094048261642456],
          [51.350269232103656, 12.093983888626099],
          [51.35026588171496, 12.093855142593384],
          [51.35023907859671, 12.09368884563446],
          [51.35021227546279, 12.093533277511597],
          [51.350185472313164, 12.093318700790405],
          [51.3501419171616, 12.093168497085571],
          [51.35010171236957, 12.093012928962708],
          [51.350084960362466, 12.092851996421814],
          [51.350071558752376, 12.09269642829895],
          [51.350071558752376, 12.092508673667908],
          [51.350078259557904, 12.092310190200806],
          [51.35010506277025, 12.092154622077942],
          [51.35017207073246, 12.092020511627197],
          [51.350269232103656, 12.09193468093872],
          [51.35034629097567, 12.091838121414185],
          [51.350466904602136, 12.091763019561768],
          [51.35056071498099, 12.09169864654541],
          [51.35074498480886, 12.091671824455261],
          [51.35094935593305, 12.091677188873291],
          [51.351237484166134, 12.091730833053589],
          [51.35145860460459, 12.091784477233887],
          [51.351766831314016, 12.091875672340393],
          [51.3519845989348, 12.09195613861084],
          [51.352212416261054, 12.092111706733704],
          [51.35243353199442, 12.092283368110657],
          [51.35258094189049, 12.092417478561401],
          [51.35267139772827, 12.092589139938354],
          [51.35266804751525, 12.092755436897278],
          [51.35264124580219, 12.093018293380737],
          [51.35261444407346, 12.093350887298584],
          [51.352594342766636, 12.09371030330658]
        ]
      },
      '11': {
        'name': 'Deponie Wallendorf I',
        'map': {center: {latitude: 51.3515, longitude: 12.0952}, zoom: 16},
        'coords': []
      }
    };
    projects['11'].coords = projects['12'].coords;
    $scope.projectId = $stateParams.id;
    $scope.project = projects[$scope.projectId];
    $scope.map = projects[$scope.projectId].map;

    function getPolyConfig(api) {
      return {
        'path': projects[$scope.projectId].coords.reduce(function (final, coordArray) {
          final.push(new api.LatLng(coordArray[0], coordArray[1]));
          return final;
        }, []),
        'fillColor': '#72AA21',
        'fillOpacity': 0.5,
        'strokeColor': '#72AA21',
        'strokeWeight': 1,
        'clickable': false,
        'draggable': false,
        'editable': false,
        'visible': true
      };
    }

    uiGmapGoogleMapApi.then(function (api) {
      uiGmapIsReady.promise(1).then(function (instances) {
        var inst = instances[0],
          map = inst.map,
          polygon = new api.Polygon(getPolyConfig(api));

        polygon.setMap(map);
      });
    });

    $scope.message = 'Hello';
  });
